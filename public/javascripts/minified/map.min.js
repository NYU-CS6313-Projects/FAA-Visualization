!function(){var a=960,b=600,c=d3.format(",.0f"),d=d3.geo.path().projection(null),e=d3.scale.sqrt().domain([0,1e6]).range([0,15]),f=d3.select("body").append("svg").attr("width",a).attr("height",b),g=f.append("g").attr("class","legend").attr("transform","translate("+(a-50)+","+(b-20)+")").selectAll("g").data([1e6,5e6,1e7]).enter().append("g");g.append("circle").attr("cy",function(a){return-e(a)}).attr("r",e),g.append("text").attr("y",function(a){return-2*e(a)}).attr("dy","1.3em").text(d3.format(".1s")),d3.json("/javascripts/us.json",function(a,b){return a?console.error(a):(f.append("path").datum(topojson.feature(b,b.objects.nation)).attr("class","land").attr("d",d),f.append("path").datum(topojson.mesh(b,b.objects.states,function(a,b){return a!==b})).attr("class","border border--state").attr("d",d),void f.append("g").attr("class","bubble").selectAll("circle").data(topojson.feature(b,b.objects.counties).features.sort(function(a,b){return b.properties.population-a.properties.population})).enter().append("circle").attr("transform",function(a){return"translate("+d.centroid(a)+")"}).attr("r",function(a){return e(a.properties.population)}).append("title").text(function(a){return a.properties.name+"\nPopulation "+c(a.properties.population)}))}),d3.select(self.frameElement).style("height",b+"px")}();